r1004 branches/gsoc2007